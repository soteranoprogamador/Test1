--[[
    Soterano HUB - Universal Aimbot & ESP
    Funcionalidades: Aimbot, FOV AjustÃ¡vel, Wall Check, Team Check, ESP Corporal
    Interface: Moderna e arredondada
--]]

-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local CoreGui = game:GetService("CoreGui")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- VariÃ¡veis Globais de ConfiguraÃ§Ã£o
local Settings = {
    AimbotEnabled = false,
    FOVRadius = 150,
    WallCheck = false,
    TeamCheck = true,
    ESPEnabled = false,
    TargetPart = "Head",
    ToggleKey = Enum.KeyCode.RightShift -- BotÃ£o para mostrar/esconder a UI
}

-- VariÃ¡veis para o Aimbot
local Aiming = false
local CurrentTarget = nil
local FOVCircle = nil
local ScreenGui = nil

-- FunÃ§Ã£o para criar a Interface GrÃ¡fica (UI)
local function CreateUI()
    -- Garantir que nÃ£o existam GUIs antigas
    local Existing = CoreGui:FindFirstChild("SoteranoHUB")
    if Existing then Existing:Destroy() end

    -- ScreenGui Principal
    ScreenGui = Instance.new("ScreenGui")
    ScreenGui.Name = "SoteranoHUB"
    ScreenGui.Parent = CoreGui
    ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

    -- Frame Principal (janela)
    local MainFrame = Instance.new("Frame")
    MainFrame.Name = "MainFrame"
    MainFrame.Parent = ScreenGui
    MainFrame.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
    MainFrame.BackgroundTransparency = 0.1
    MainFrame.BorderSizePixel = 0
    MainFrame.Position = UDim2.new(0.02, 0, 0.5, -200) -- Lado esquerdo, centralizado verticalmente
    MainFrame.Size = UDim2.new(0, 300, 0, 400)
    MainFrame.ClipsDescendants = true

    -- Sombra/Outline sutil
    local Stroke = Instance.new("UIStroke")
    Stroke.Parent = MainFrame
    Stroke.Color = Color3.fromRGB(45, 45, 55)
    Stroke.Thickness = 2
    Stroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border

    -- Cantos arredondados (principal)
    local MainCorner = Instance.new("UICorner")
    MainCorner.Parent = MainFrame
    MainCorner.CornerRadius = UDim.new(0, 12)

    -- TÃ­tulo
    local TitleLabel = Instance.new("TextLabel")
    TitleLabel.Parent = MainFrame
    TitleLabel.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
    TitleLabel.BackgroundTransparency = 0.3
    TitleLabel.BorderSizePixel = 0
    TitleLabel.Size = UDim2.new(1, 0, 0, 50)
    TitleLabel.Position = UDim2.new(0, 0, 0, 0)
    TitleLabel.Font = Enum.Font.GothamBold
    TitleLabel.Text = "Soterano HUB"
    TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    TitleLabel.TextSize = 22

    -- Cantos arredondados (tÃ­tulo)
    local TitleCorner = Instance.new("UICorner")
    TitleCorner.Parent = TitleLabel
    TitleCorner.CornerRadius = UDim.new(0, 12)

    -- Container para os controles
    local Container = Instance.new("ScrollingFrame")
    Container.Parent = MainFrame
    Container.BackgroundTransparency = 1
    Container.BorderSizePixel = 0
    Container.Position = UDim2.new(0, 10, 0, 60)
    Container.Size = UDim2.new(1, -20, 1, -70)
    Container.CanvasSize = UDim2.new(0, 0, 2.5, 0) -- EspaÃ§o para scroll
    Container.ScrollBarThickness = 5
    Container.ScrollBarImageColor3 = Color3.fromRGB(80, 80, 100)

    local function CreateToggle(parent, text, setting, callback)
        local ToggleFrame = Instance.new("Frame")
        ToggleFrame.Parent = parent
        ToggleFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
        ToggleFrame.BorderSizePixel = 0
        ToggleFrame.Size = UDim2.new(1, -10, 0, 45)
        ToggleFrame.Position = UDim2.new(0, 5, 0, 0)

        local ToggleCorner = Instance.new("UICorner")
        ToggleCorner.Parent = ToggleFrame
        ToggleCorner.CornerRadius = UDim.new(0, 8)

        local Label = Instance.new("TextLabel")
        Label.Parent = ToggleFrame
        Label.BackgroundTransparency = 1
        Label.Size = UDim2.new(0.7, -10, 1, 0)
        Label.Position = UDim2.new(0, 10, 0, 0)
        Label.Font = Enum.Font.Gotham
        Label.Text = text
        Label.TextColor3 = Color3.fromRGB(220, 220, 220)
        Label.TextSize = 16
        Label.TextXAlignment = Enum.TextXAlignment.Left

        local ToggleButton = Instance.new("TextButton")
        ToggleButton.Parent = ToggleFrame
        ToggleButton.BackgroundColor3 = setting and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(150, 50, 50)
        ToggleButton.BorderSizePixel = 0
        ToggleButton.Size = UDim2.new(0.25, -10, 0, 25)
        ToggleButton.Position = UDim2.new(0.75, 0, 0.5, -12.5)
        ToggleButton.Font = Enum.Font.Gotham
        ToggleButton.Text = setting and "ON" or "OFF"
        ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
        ToggleButton.TextSize = 14

        local ButtonCorner = Instance.new("UICorner")
        ButtonCorner.Parent = ToggleButton
        ButtonCorner.CornerRadius = UDim.new(0, 6)

        ToggleButton.MouseButton1Click:Connect(function()
            setting = not setting
            ToggleButton.BackgroundColor3 = setting and Color3.fromRGB(0, 200, 100) or Color3.fromRGB(150, 50, 50)
            ToggleButton.Text = setting and "ON" or "OFF"
            if callback then callback(setting) end
        end)

        return ToggleFrame
    end

    local function CreateSlider(parent, text, min, max, setting, callback)
        local SliderFrame = Instance.new("Frame")
        SliderFrame.Parent = parent
        SliderFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
        SliderFrame.BorderSizePixel = 0
        SliderFrame.Size = UDim2.new(1, -10, 0, 70)
        SliderFrame.Position = UDim2.new(0, 5, 0, 0)

        local SliderCorner = Instance.new("UICorner")
        SliderCorner.Parent = SliderFrame
        SliderCorner.CornerRadius = UDim.new(0, 8)

        local Label = Instance.new("TextLabel")
        Label.Parent = SliderFrame
        Label.BackgroundTransparency = 1
        Label.Size = UDim2.new(1, -20, 0, 20)
        Label.Position = UDim2.new(0, 10, 0, 10)
        Label.Font = Enum.Font.Gotham
        Label.Text = text .. ": " .. tostring(setting)
        Label.TextColor3 = Color3.fromRGB(220, 220, 220)
        Label.TextSize = 16
        Label.TextXAlignment = Enum.TextXAlignment.Left

        local BarBackground = Instance.new("Frame")
        BarBackground.Parent = SliderFrame
        BarBackground.BackgroundColor3 = Color3.fromRGB(55, 55, 65)
        BarBackground.BorderSizePixel = 0
        BarBackground.Size = UDim2.new(0.9, 0, 0, 4)
        BarBackground.Position = UDim2.new(0.05, 0, 0.7, 0)

        local BarCorner = Instance.new("UICorner")
        BarCorner.Parent = BarBackground
        BarCorner.CornerRadius = UDim.new(0, 4)

        local BarFill = Instance.new("Frame")
        BarFill.Parent = BarBackground
        BarFill.BackgroundColor3 = Color3.fromRGB(0, 160, 255)
        BarFill.BorderSizePixel = 0
        BarFill.Size = UDim2.new((setting - min) / (max - min), 0, 1, 0)

        local FillCorner = Instance.new("UICorner")
        FillCorner.Parent = BarFill
        FillCorner.CornerRadius = UDim.new(0, 4)

        local ValueLabel = Instance.new("TextLabel")
        ValueLabel.Parent = SliderFrame
        ValueLabel.BackgroundTransparency = 1
        ValueLabel.Size = UDim2.new(1, -20, 0, 20)
        ValueLabel.Position = UDim2.new(0, 10, 0, 40)
        ValueLabel.Font = Enum.Font.Gotham
        ValueLabel.Text = tostring(math.floor(setting))
        ValueLabel.TextColor3 = Color3.fromRGB(0, 160, 255)
        ValueLabel.TextSize = 14
        ValueLabel.TextXAlignment = Enum.TextXAlignment.Right

        local dragging = false
        BarBackground.InputBegan:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = true
            end
        end)
        BarBackground.InputEnded:Connect(function(input)
            if input.UserInputType == Enum.UserInputType.MouseButton1 then
                dragging = false
            end
        end)

        RunService.RenderStepped:Connect(function()
            if dragging then
                local mousePos = UserInputService:GetMouseLocation()
                local absPos = BarBackground.AbsolutePosition
                local sizeX = BarBackground.AbsoluteSize.X
                local relativeX = math.clamp(mousePos.X - absPos.X, 0, sizeX)
                local newValue = min + (relativeX / sizeX) * (max - min)
                newValue = math.floor(newValue)
                Label.Text = text .. ": " .. tostring(newValue)
                ValueLabel.Text = tostring(newValue)
                BarFill.Size = UDim2.new(relativeX / sizeX, 0, 1, 0)
                if callback then callback(newValue) end
            end
        end)

        return SliderFrame
    end

    -- Posicionamento dos Elementos
    local YPos = 0

    -- TÃ­tulo da seÃ§Ã£o Aimbot
    local AimSection = Instance.new("TextLabel")
    AimSection.Parent = Container
    AimSection.BackgroundTransparency = 1
    AimSection.Size = UDim2.new(1, 0, 0, 30)
    AimSection.Position = UDim2.new(0, 0, 0, YPos)
    AimSection.Font = Enum.Font.GothamBold
    AimSection.Text = "âš¡ Aimbot"
    AimSection.TextColor3 = Color3.fromRGB(100, 200, 255)
    AimSection.TextSize = 20
    AimSection.TextXAlignment = Enum.TextXAlignment.Left
    YPos = YPos + 35

    -- Toggle Aimbot
    local AimbotToggle = CreateToggle(Container, "Ativar Aimbot", Settings.AimbotEnabled, function(value)
        Settings.AimbotEnabled = value
        if not value then
            CurrentTarget = nil
        end
    end)
    AimbotToggle.Position = UDim2.new(0, 0, 0, YPos)
    YPos = YPos + 50

    -- Slider FOV
    local FOVSlider = CreateSlider(Container, "FOV", 50, 400, Settings.FOVRadius, function(value)
        Settings.FOVRadius = value
        if FOVCircle then
            FOVCircle.Size = UDim2.new(0, value * 2, 0, value * 2)
        end
    end)
    FOVSlider.Position = UDim2.new(0, 0, 0, YPos)
    YPos = YPos + 75

    -- Toggles de Check
    local WallCheckToggle = CreateToggle(Container, "Wall Check", Settings.WallCheck, function(value)
        Settings.WallCheck = value
    end)
    WallCheckToggle.Position = UDim2.new(0, 0, 0, YPos)
    YPos = YPos + 50

    local TeamCheckToggle = CreateToggle(Container, "Team Check", Settings.TeamCheck, function(value)
        Settings.TeamCheck = value
    end)
    TeamCheckToggle.Position = UDim2.new(0, 0, 0, YPos)
    YPos = YPos + 50

    -- TÃ­tulo da seÃ§Ã£o ESP
    local EspSection = Instance.new("TextLabel")
    EspSection.Parent = Container
    EspSection.BackgroundTransparency = 1
    EspSection.Size = UDim2.new(1, 0, 0, 30)
    EspSection.Position = UDim2.new(0, 0, 0, YPos)
    EspSection.Font = Enum.Font.GothamBold
    EspSection.Text = "ðŸ‘ï¸ ESP"
    EspSection.TextColor3 = Color3.fromRGB(100, 255, 150)
    EspSection.TextSize = 20
    EspSection.TextXAlignment = Enum.TextXAlignment.Left
    YPos = YPos + 35

    local ESPToggle = CreateToggle(Container, "Ativar ESP", Settings.ESPEnabled, function(value)
        Settings.ESPEnabled = value
    end)
    ESPToggle.Position = UDim2.new(0, 0, 0, YPos)

    -- Atualizar CanvasSize para permitir scroll
    Container.CanvasSize = UDim2.new(0, 0, 0, YPos + 100)
end

-- FunÃ§Ã£o para desenhar o cÃ­rculo do FOV
local function CreateFOVCircle()
    if FOVCircle then FOVCircle:Destroy() end
    FOVCircle = Instance.new("Frame")
    FOVCircle.Name = "FOVCircle"
    FOVCircle.Parent = ScreenGui
    FOVCircle.BackgroundTransparency = 1
    FOVCircle.BorderSizePixel = 2
    FOVCircle.BorderColor3 = Color3.fromRGB(0, 200, 255)
    FOVCircle.Size = UDim2.new(0, Settings.FOVRadius * 2, 0, Settings.FOVRadius * 2)
    FOVCircle.Position = UDim2.new(0.5, -Settings.FOVRadius, 0.5, -Settings.FOVRadius)
    FOVCircle.ZIndex = 100

    local CircleCorner = Instance.new("UICorner")
    CircleCorner.Parent = FOVCircle
    CircleCorner.CornerRadius = UDim.new(0.5, 0)
end

-- FunÃ§Ãµes de Utilidade para o Aimbot/ESP
local function IsPlayerAlive(player)
    return player.Character and player.Character:FindFirstChild("Humanoid") and player.Character.Humanoid.Health > 0
end

local function IsTeamMate(player)
    if not Settings.TeamCheck then return false end
    if player.Team == nil or LocalPlayer.Team == nil then return false end
    return player.Team == LocalPlayer.Team
end

local function IsTargetVisible(character)
    if not Settings.WallCheck then return true end
    local origin = Camera.CFrame.Position
    local targetPart = character:FindFirstChild(Settings.TargetPart) or character:FindFirstChild("HumanoidRootPart")
    if not targetPart then return false end

    local direction = (targetPart.Position - origin).Unit
    local ray = Ray.new(origin, direction * 500)
    local hit, pos = workspace:FindPartOnRayWithIgnoreList(ray, {LocalPlayer.Character, Camera})

    if hit then
        local hitParent = hit:IsDescendantOf(character)
        return hitParent
    end
    return true
end

local function GetClosestTargetToFOV()
    local closestPlayer = nil
    local shortestDistance = Settings.FOVRadius

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and IsPlayerAlive(player) and not IsTeamMate(player) then
            local character = player.Character
            local targetPart = character:FindFirstChild(Settings.TargetPart) or character:FindFirstChild("HumanoidRootPart")
            if targetPart then
                local screenPos, onScreen = Camera:WorldToScreenPoint(targetPart.Position)
                if onScreen then
                    local distance = (Vector2.new(screenPos.X, screenPos.Y) - Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)).Magnitude
                    if distance < shortestDistance and IsTargetVisible(character) then
                        shortestDistance = distance
                        closestPlayer = player
                    end
                end
            end
        end
    end
    return closestPlayer
end

-- FunÃ§Ã£o do ESP Corporal (Desenha o corpo do jogador)
local function DrawESP()
    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and IsPlayerAlive(player) and not IsTeamMate(player) then
            local character = player.Character
            if character and Settings.ESPEnabled then
                for _, part in ipairs(character:GetChildren()) do
                    if part:IsA("BasePart") and part.Name ~= "HumanoidRootPart" then
                        -- Criar ou atualizar o Highlight
                        if not part:FindFirstChild("ESP_Outline") then
                            local highlight = Instance.new("BoxHandleAdornment")
                            highlight.Name = "ESP_Outline"
                            highlight.Adornee = part
                            highlight.ZIndex = 10
                            highlight.Size = part.Size + Vector3.new(0.05, 0.05, 0.05)
                            highlight.Color3 = Color3.fromRGB(255, 50, 50) -- Vermelho para inimigos
                            highlight.Transparency = 0.5
                            highlight.AlwaysOnTop = true
                            highlight.Parent = part
                        else
                            local highlight = part:FindFirstChild("ESP_Outline")
                            if highlight then
                                highlight.Visible = Settings.ESPEnabled
                                highlight.Size = part.Size + Vector3.new(0.05, 0.05, 0.05)
                            end
                        end
                    end
                end
            end
        end
    end
end

-- Loop principal do Aimbot
RunService.RenderStepped:Connect(function()
    -- Gerenciar FOV Circle
    if ScreenGui and Settings.AimbotEnabled then
        if not FOVCircle then
            CreateFOVCircle()
        end
    else
        if FOVCircle then
            FOVCircle:Destroy()
            FOVCircle = nil
        end
    end

    -- Aimbot
    if Settings.AimbotEnabled then
        local target = GetClosestTargetToFOV()
        if target then
            local character = target.Character
            local targetPart = character:FindFirstChild(Settings.TargetPart) or character:FindFirstChild("HumanoidRootPart")
            if targetPart then
                Camera.CFrame = CFrame.lookAt(Camera.CFrame.Position, targetPart.Position)
            end
        end
    end

    -- ESP
    DrawESP()
end)

-- Toggle UI com a tecla (RightShift por padrÃ£o)
UserInputService.InputBegan:Connect(function(input)
    if input.KeyCode == Settings.ToggleKey then
        if ScreenGui and ScreenGui.MainFrame then
            ScreenGui.MainFrame.Visible = not ScreenGui.MainFrame.Visible
        end
    end
end)

-- Inicializar tudo
CreateUI()
CreateFOVCircle()

print("âœ… Soterano HUB carregado com sucesso! Pressione RightShift para abrir/fechar.")
